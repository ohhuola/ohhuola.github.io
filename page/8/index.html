<!DOCTYPE html>
<html>

<head><meta name="generator" content="Hexo 3.8.0">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="theme-color" content="#33474d">
	<title>Security Learning</title>
	<link rel="stylesheet" href="/css/style.css">
	
      <link rel="alternate" href="/atom.xml" title="Security Learning" type="application/atom+xml">
    
</head>

<body>

	<header class="header">
		<nav class="header__nav">
			
				<a href="/archives" class="header__link">Archive</a>
			
				<a href="/categories" class="header__link">Categories</a>
			
				<a href="/about" class="header__link">About</a>
			
		</nav>
		<h1 class="header__title"><a href="/">Security Learning</a></h1>
		<h2 class="header__subtitle">on own time</h2>
	</header>

	<main>
		
	<span class="different-posts different-posts_earlier">📖 <a href="/page/7">earlier posts</a> 📖</span>




	<article>
	
		<h1><a href="/2019/05/03/nachos1/">NachOS源码学习(一)：线程升级</a></h1>
	
	<div class="article__infos">
		<span class="article__date">2019-05-03</span><br>
		
			<span class="article__category">
				<a class="article-category-link" href="/categories/OS/">OS</a>
			</span><br>
		
		
			<span class="article__tags">
			  	<a class="article__tag-link" href="/tags/NachOS/">NachOS</a>
			</span>
		
	</div>

	

	
		<h2 id="NachOS简介"><a href="#NachOS简介" class="headerlink" title="NachOS简介"></a>NachOS简介</h2><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><blockquote>
<p>Nachos的全称是“Not Another Completely Heuristic Operating System”，它是一个可修改和跟踪的操作系统教学软件。它给出了一个支持多线程和虚拟存储的操作系统骨架，可让学生在较短的时间内对操作系统中的基本原理和核心算法有一个全面和完整的了解。</p>
</blockquote>
<h4 id="NachOS工作机制"><a href="#NachOS工作机制" class="headerlink" title="NachOS工作机制"></a>NachOS工作机制</h4><p><figure class="figure"><img src="https://i.loli.net/2019/05/03/5ccc075bd7d08.jpg" alt="1.jpg"><figcaption class="figure__caption">1.jpg</figcaption></figure></p>
<h4 id="NachOS源码的大体结构"><a href="#NachOS源码的大体结构" class="headerlink" title="NachOS源码的大体结构"></a>NachOS源码的大体结构</h4><p><figure class="figure"><img src="https://i.loli.net/2019/05/03/5ccc076093d5a.png" alt="2.jpg"><figcaption class="figure__caption">2.jpg</figcaption></figure></p>
<h2 id="NachOS源码学习-线程模块"><a href="#NachOS源码学习-线程模块" class="headerlink" title="NachOS源码学习:线程模块"></a>NachOS源码学习:线程模块</h2><h4 id="理论部分"><a href="#理论部分" class="headerlink" title="理论部分:"></a>理论部分:</h4><p>Nachos 广泛采用线程的概念，是多线程操作系统。线程是Nachos处理机调度的单位，在Nachos中线程分成两类:</p>
<ul>
<li>系统线程。所谓<strong>系统线程是只运行核心代码的线程</strong>，它运行在核心态下，并且占用宿主机的资源，系统线程共享Nachos操作系统本身的正文段和数据段；<strong>一个系统线程完成一件独立的任务</strong>，比如在Nachos网络部分，有一个独立的线程一直监测有无发给自己的数据报。 </li>
<li>用户线程。Nachos的另一类线程同Nachos中的用户进程有关。Nachos中用户进程由两部分组成，核心代码部分和用户程序部分。用户进程的进程控制块是线程控制块基础上的扩充。<strong>每当系统接收到生成用户进程的请求时，首先生成一个系统线程</strong>，进程控制块中有保存线程运行现场的空间，保证线程切换时现场不会丢失。<strong>该线程的作用是给用户程序分配虚拟机内存空间，并把用户程序的代码段和数据段装入用户地址空间，然后调用解释器解释执行用户程序</strong>；由于Nachos模拟的是一个单机环境，多个用户进程会竞争使用Nachos唯一的处理机资源，所以在<strong>Nachos用户进程的进程控制块中增加有虚拟机运行现场空间以及进程的地址空间指针等内容</strong>，保证用户进程在虚拟机上的正常运行。系统线程竞争使用宿主机的CPU资源，而用户进程的用户程序部分 竞争使用的是虚拟机的CPU和寄存器。</li>
</ul>
<h4 id="NachOS线程管理的特点"><a href="#NachOS线程管理的特点" class="headerlink" title="NachOS线程管理的特点"></a>NachOS线程管理的特点</h4><ol>
<li>线程个数没有限制。一般的操作系统，进程的数目是有限的，但是Nachos 中线程数目是无限的。线程的控制结构和系统线程的运行是占用宿主机的。能够开多少线程完全由宿主机条件限制，理论上是无限的。</li>
<li>线程调度简单。启动了时钟中断的情况下，当时钟中断到来时。如果就绪线程队列中有就绪线程，就必须进行线程切换。没有启动时钟中断的情况下，Nachos使用非抢占式调度，即进程在运行过程中不会切换到其它进程运行，除非其主动放弃处理机或者运行结束。</li>
<li>线程数据结构简单。Nachos中线程数据结构定义简单，没用户ID，线程ID，无法根据线程ID实现通信，同步互斥，也没有全局性的线程管理机制。</li>
</ol>

	

	

</article>





	<span class="different-posts">📖 <a href="/page/9">more posts</a> 📖</span>



	</main>

	<footer class="footer">
	<div class="footer-content">
		
	      <div class="footer__element">
	<p>Hi there, <br>welcome to my Blog glad you found it. Have a look around, will you?</p>
</div>

	    
	      <div class="footer__element">
	<h5>Check out</h5>
	<ul class="footer-links">
		<li class="footer-links__link"><a href="/archives">Archive</a></li>
		
		  <li class="footer-links__link"><a href="/atom.xml">RSS</a></li>
	    
		<li class="footer-links__link"><a href="/about">about page</a></li>
		<li class="footer-links__link"><a href="/tags">Tags</a></li>
		<li class="footer-links__link"><a href="/categories">Categories</a></li>
	</ul>
</div>

	    

		<div class="footer-credit">
			<span>© 2020 Lexie oh | Powered by <a href="https://hexo.io/">Hexo</a> | Theme <a href="https://github.com/HoverBaum/meilidu-hexo">MeiliDu</a></span>
		</div>

	</div>


</footer>



</body>

</html>
